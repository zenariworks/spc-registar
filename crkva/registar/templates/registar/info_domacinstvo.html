{% extends "base.html" %}
{% load phone_filters %}
{% block content %}

<div class="u-page-header">
    <a href="{% url 'domacinstva' %}" class="back-button" aria-label="–ù–∞–∑–∞–¥" title="–ù–∞–∑–∞–¥ –Ω–∞ —Å–ø–∏—Å–∞–∫">
        <i class="fa-solid fa-arrow-left"></i>
    </a>
    <h1 class="u-page-title">–î–æ–º–∞—õ–∏–Ω—Å—Ç–≤–æ</h1>
</div>

<div class="card" style="margin-bottom: var(--space-6);">
    <h2 style="margin-top: 0; margin-bottom: var(--space-4); display: flex; align-items: center; gap: 10px;">
        <i class="fa-solid fa-house" style="color: var(--color-text-muted);"></i>
        –î–æ–º–∞—õ–∏–Ω:
        <a href="{% url 'parohijan_detail' uid=domacinstvo.domacin.uid %}" style="color: var(--color-primary); text-decoration: none;">
            {{ domacinstvo.domacin.ime }} {{ domacinstvo.domacin.prezime }}
        </a>
    </h2>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-4); margin-top: var(--space-5);">
        {% if domacinstvo.adresa %}
        <div>
            <strong style="color: var(--color-text-muted);">–ê–¥—Ä–µ—Å–∞:</strong><br>
            üìç {{ domacinstvo.adresa }}
        </div>
        {% endif %}

        {% if domacinstvo.tel_fiksni or domacinstvo.tel_mobilni %}
        <div>
            <strong style="color: var(--color-text-muted);">–¢–µ–ª–µ—Ñ–æ–Ω:</strong><br>
            {% if domacinstvo.tel_mobilni %}
                <a href="tel:{{ domacinstvo.tel_mobilni|tel_link }}" style="color: var(--color-primary); text-decoration: none;">
                    <i class="fa-solid {{ domacinstvo.tel_mobilni|phone_icon }}"></i>
                    {{ domacinstvo.tel_mobilni|format_phone }}
                </a>{% if domacinstvo.tel_fiksni %}<br>{% endif %}
            {% endif %}
            {% if domacinstvo.tel_fiksni %}
                <a href="tel:{{ domacinstvo.tel_fiksni|tel_link }}" style="color: var(--color-primary); text-decoration: none;">
                    <i class="fa-solid {{ domacinstvo.tel_fiksni|phone_icon }}"></i>
                    {{ domacinstvo.tel_fiksni|format_phone }}
                </a>
            {% endif %}
        </div>
        {% endif %}

        {% if domacinstvo.slava %}
        <div>
            <strong style="color: var(--color-text-muted);">–°–ª–∞–≤–∞:</strong><br>
            <span style="color: var(--color-slava-text); background: var(--color-slava-bg); padding: 4px 10px; border-radius: 4px; display: inline-block;">
                {{ domacinstvo.slava }}
            </span>
        </div>
        {% endif %}

        <div>
            <strong style="color: var(--color-text-muted);">–í–æ–¥–∏—Ü–µ:</strong><br>
            {% if domacinstvo.slavska_vodica %}‚úÖ –°–ª–∞–≤—Å–∫–∞ –≤–æ–¥–∏—Ü–∞<br>{% endif %}
            {% if domacinstvo.vaskrsnja_vodica %}‚úÖ –í–∞—Å–∫—Ä—à—ö–∞ –≤–æ–¥–∏—Ü–∞{% endif %}
            {% if not domacinstvo.slavska_vodica and not domacinstvo.vaskrsnja_vodica %}‚Äî{% endif %}
        </div>
    </div>

    {% if domacinstvo.napomena %}
    <div style="margin-top: var(--space-5); padding: var(--space-4); background: var(--color-surface); border-left: 4px solid var(--color-primary); border-radius: 4px;">
        <strong style="color: var(--color-text-muted);">–ù–∞–ø–æ–º–µ–Ω–∞:</strong><br>
        {{ domacinstvo.napomena }}
    </div>
    {% endif %}
</div>

{% if ukucani_zivi or ukucani_preminuli %}
<div style="margin-top: var(--space-6);">
    <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: var(--space-5);">
        <i class="fa-solid fa-users"></i>
        –ß–ª–∞–Ω–æ–≤–∏ –¥–æ–º–∞—õ–∏–Ω—Å—Ç–≤–∞
    </h2>

    {% if ukucani_zivi %}
    <div style="margin-bottom: var(--space-6);">
        <h3 style="color: var(--color-success); margin-bottom: var(--space-4);">
            <i class="fa-solid fa-circle" style="font-size: 0.5em; vertical-align: middle;"></i>
            –ñ–∏–≤–∏ —á–ª–∞–Ω–æ–≤–∏ ({{ ukucani_zivi|length }})
        </h3>
        <ul class="spisak">
            {% for ukucanin in ukucani_zivi %}
            <li class="stavka" style="border-left: 4px solid var(--color-success);">
                <div style="flex: 1;">
                    <div style="font-weight: 500; margin-bottom: 5px;">
                        {% if ukucanin.osoba %}
                            <a href="{% url 'parohijan_detail' uid=ukucanin.osoba.uid %}" style="color: var(--color-primary); text-decoration: none;">
                                {{ ukucanin.osoba.ime }} {{ ukucanin.osoba.prezime }}
                            </a>
                        {% else %}
                            {{ ukucanin.ime_ukucana }}
                        {% endif %}
                    </div>
                    <div style="color: var(--color-text-muted); font-size: 0.9em;">
                        <span style="background: var(--color-primary-50); padding: 2px 8px; border-radius: 3px;">
                            {{ ukucanin.get_uloga_display }}
                        </span>
                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if ukucani_preminuli %}
    <div>
        <h3 style="color: var(--color-text-muted); margin-bottom: var(--space-4);">
            <i class="fa-solid fa-circle" style="font-size: 0.5em; vertical-align: middle;"></i>
            –ü—Ä–µ–º–∏–Ω—É–ª–∏ —á–ª–∞–Ω–æ–≤–∏ ({{ ukucani_preminuli|length }})
        </h3>
        <ul class="spisak">
            {% for ukucanin in ukucani_preminuli %}
            <li class="stavka" style="border-left: 4px solid var(--color-text-muted); opacity: 0.7;">
                <div style="flex: 1;">
                    <div style="font-weight: 500; margin-bottom: 5px; text-decoration: line-through;">
                        {% if ukucanin.osoba %}
                            {{ ukucanin.osoba.ime }} {{ ukucanin.osoba.prezime }}
                        {% else %}
                            {{ ukucanin.ime_ukucana }}
                        {% endif %}
                        ‚Ä†
                    </div>
                    <div style="color: var(--color-text-muted); font-size: 0.9em;">
                        <span style="background: var(--color-surface-2); padding: 2px 8px; border-radius: 3px;">
                            {{ ukucanin.get_uloga_display }}
                        </span>
                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>
{% else %}
<div class="card" style="padding: var(--space-6); text-align: center; color: var(--color-text-muted);">
    <i class="fa-solid fa-users" style="font-size: 2em; margin-bottom: 10px; opacity: 0.5;"></i>
    <p>–ù–µ–º–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ –æ —á–ª–∞–Ω–æ–≤–∏–º–∞ –¥–æ–º–∞—õ–∏–Ω—Å—Ç–≤–∞.</p>
</div>
{% endif %}

{% endblock %}
