<!-- header.html -->
{% load static %}
<header>
  <div class="container header-bar">
    <div class="fusion-logo">
       <a href="{% url 'pocetna' %}">
       <img src="https://spc.rs/wp-content/uploads/2022/03/spc-logo.png" alt="Logo –°–ü–¶">
       </a>
    </div>
    <div class="menu-search-wrapper">
       <button class="hamburger-menu" onclick="toggleMenu()" aria-label="–û—Ç–≤–æ—Ä–∏ –º–µ–Ω–∏">
       <i class="ti-menu"></i>
       </button>
       <nav id="menu" aria-label="–ì–ª–∞–≤–Ω–∏ –º–µ–Ω–∏">
         <ul>
         {% url 'krstenja' as krstenja_url %}
         {% url 'vencanja' as vencanja_url %}
         {% url 'unos_krstenja' as unos_krstenja_url %}
         {% url 'unos_vencanja' as unos_vencanja_url %}
         {% url 'unos_parohijana' as unos_parohijana_url %}
         <li><a href="{{ krstenja_url }}" class="{% if request.path == krstenja_url %}active{% endif %}">–ö—Ä—à—Ç–µ—ö–∞</a></li>
         <li><a href="{{ vencanja_url }}" class="{% if request.path == vencanja_url %}active{% endif %}">–í–µ–Ω—á–∞—ö–∞</a></li>
         <li>
            <a href="#">–£–Ω–æ—Å–∏</a>
            <ul class="dropdown">
               <li><a href="{{ unos_krstenja_url }}" class="{% if request.path == unos_krstenja_url %}active{% endif %}">–ö—Ä—à—Ç–µ—ö–µ</a></li>
               <li><a href="{{ unos_vencanja_url }}" class="{% if request.path == unos_vencanja_url %}active{% endif %}">–í–µ–Ω—á–∞—ö–µ</a></li>
               <li><a href="{{ unos_parohijana_url }}" class="{% if request.path == unos_parohijana_url %}active{% endif %}">–ü–∞—Ä–æ—Ö–∏—ò–∞–Ω</a></li>
            </ul>
         </li>
           <li class="theme-icon">
              <a href="#" id="theme-toggle" class="fusion-main-menu-icon" aria-label="–ü—Ä–æ–º–µ–Ω–∏ —Ç–µ–º—É">üåì</a>
           </li>
           <li class="search-icon">
              <a href="#" id="search-trigger" class="fusion-main-menu-icon">
              <i class="ti-search"></i>
              </a>
           </li>
        </ul>
       </nav>
       <div id="search-overlay" style="display: none;">
         <form method="get" action="{% url 'search_view' %}" class="search-form">
            <div class="search-box">
               <button type="submit" class="search-icon-button"><i class="ti-search"></i></button>
               <input type="text" name="query" placeholder="–ü—Ä–µ—Ç—Ä–∞–≥–∞..." autofocus>
               <a href="#" id="close-search" class="close-search"><i class="ti-close"></i></a>
            </div>
         </form>
       </div>
    </div>
  </div>
  <script>
     document.getElementById('search-trigger').addEventListener('click', function(event) {
       event.preventDefault();
       document.getElementById("menu").style.display = "none";
       document.getElementById('search-overlay').style.display = 'flex';
     });

     document.getElementById('close-search').addEventListener('click', function(event) {
       event.preventDefault();
       document.getElementById('search-overlay').style.display = 'none';
       document.getElementById("menu").style.display = "flex";
     });
     // ESC zatvara pretragu
     document.addEventListener('keydown', function(event) {
       if (event.key === 'Escape') {
         document.getElementById('search-overlay').style.display = 'none';
         document.getElementById("menu").style.display = "flex";
       }
     });
     // Klik van polja zatvara pretragu
     document.addEventListener('click', function(event) {
       const overlay = document.getElementById('search-overlay');
       const searchTrigger = document.getElementById('search-trigger');
       if (!overlay.contains(event.target) && event.target !== searchTrigger) {
         if (overlay.style.display === 'flex') {
           overlay.style.display = 'none';
           document.getElementById("menu").style.display = "flex";
         }
       }
     });

     // Theme toggle
     (function() {
       var toggle = document.getElementById('theme-toggle');
       function setTheme(t) {
         document.documentElement.setAttribute('data-theme', t);
         try { localStorage.setItem('theme', t); } catch(e){}
       }
       function getTheme() {
         return document.documentElement.getAttribute('data-theme') || 'light';
       }
       if (toggle) {
         toggle.addEventListener('click', function(event) {
           event.preventDefault();
           var next = getTheme() === 'dark' ? 'light' : 'dark';
           setTheme(next);
         });
       }
     })();
     function toggleMenu() {
       var menu = document.getElementById("menu");
       if (menu.classList.contains("open")) {
           menu.classList.remove("open");
       } else {
           menu.classList.add("open");
       }
     }
  </script>
</header>
